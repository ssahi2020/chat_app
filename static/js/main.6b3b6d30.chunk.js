(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{123:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(21),s=n.n(r),o=(n(66),n(2)),i=n(3),c=n(5),u=n(4),p=n(27),m=n(6),h=(n(67),n(52)),g=n.n(h),d=function(){var e=localStorage.getItem("user_id"),t=localStorage.getItem("username");return e&&t?(console.log("Still signed in!"),!0):(console.log("signed out..."),!1)},f=n(15),y=n.n(f),b=n(22),v=n(17),E=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={isDone:!1},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("logging out component"),e.next=3,fetch("/api/users/logout",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"get"}).then((function(){localStorage.clear(),t.props.logUserOut(),t.setState({isDone:!0})}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return!0===this.state.isDone?l.a.createElement(v.a,{to:"/login"}):l.a.createElement("p",null,"logging out")}}]),t}(l.a.Component),j=n(43),C=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).logOutlogIn=function(){console.log(d()),d()&&(n.props.history.push("/logout"),console.log("pushed to logout"))},n.state={},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"App-header",style:{backgroundImage:"url(".concat(g.a,")"),height:"100px",paddingTop:0,marginTop:0}},l.a.createElement(j.a,{style:{width:"84px",height:"45px",float:"right"},onClick:function(){return e.logOutlogIn()}}," ",d()?"Log Out":"Log In"," "),l.a.createElement("h1",{style:{fontSize:"50pt",textAlign:"center",color:"white",maxHeight:"100px",paddingTop:0,marginTop:0}},"Belay"))}}]),t}(l.a.Component),_=Object(v.g)(C),O=n(8),S=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{style:{border:"1px solid black",marginTop:"50px",minWidth:"250px",borderRadius:"0"}},l.a.createElement("h2",{style:{marginTop:"50px"}},"404 page not found "),l.a.createElement("div",{style:{fontSize:"16px",marginBottom:"8px"}},"Click ",l.a.createElement(O.b,{to:"/"},"here")," to get back to safety"))}}]),t}(l.a.Component),k=Object(v.g)(S),w=n(127),x=n(126),I=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).changeUsername=function(e){n.setState({username:e.target.value})},n.changePassword=function(e){n.setState({password:e.target.value})},n.logIn=Object(b.a)(y.a.mark((function e(){var t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({loading:!0});case 2:return localStorage.clear(),e.next=5,fetch("/api/login",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({username:n.state.username,password:n.state.password})});case 5:if(200!==(t=e.sent).status){e.next=20;break}return e.next=9,t.json();case 9:a=e.sent,console.log(a),localStorage.setItem("user_id",a.user_id),localStorage.setItem("username",a.username),localStorage.setItem("email",a.email),localStorage.setItem("first_name",a.first_name),localStorage.setItem("last_name",a.last_name),n.props.logUserIn(),n.setState({toChannel:!0}),e.next=21;break;case 20:n.setState({attempt:!0});case 21:case"end":return e.stop()}}),e)}))),n.state={username:null,password:null,toChannel:!1,attempt:!1},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return!0===this.state.toChannel?l.a.createElement(v.a,{to:"/channel"}):l.a.createElement("div",{className:"App-login",style:{border:"1px solid black",width:"75%",margin:"auto",maxWidth:"300px",minWidth:"200px"}},l.a.createElement("div",{style:{textAlign:"center",margin:"auto"}},l.a.createElement(w.a,null,l.a.createElement("label",null,"Username"),l.a.createElement(x.a,{type:"text",placeholder:"username",size:"large",onChange:this.changeUsername})),l.a.createElement(w.a,null,l.a.createElement("label",null,"Password"),l.a.createElement(x.a,{type:"password",size:"large",onChange:this.changePassword})),l.a.createElement("div",null,l.a.createElement(j.a,{type:"primary",onClick:this.logIn},"Log In"))),l.a.createElement("div",{style:{fontSize:"12px",marginBottom:"8px"}},l.a.createElement(O.b,{to:"/signup"},"Sign Up"),l.a.createElement("br",null),l.a.createElement(O.b,{to:"/forgotpwd"},"Forgot Password?")),this.state.attempt?l.a.createElement("p",null,"Wrong Username/Password Combo"):null)}}]),t}(l.a.Component),N=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).changeUsername=function(e){n.setState({username:e.target.value})},n.changePassword=function(e){n.setState({password:e.target.value})},n.changeConfirmation=function(e){n.setState({confirmation:e.target.value})},n.changeFirstName=function(e){n.setState({first_name:e.target.value})},n.changeLastName=function(e){n.setState({last_name:e.target.value})},n.changeEmail=function(e){n.setState({email:e.target.value})},n.signUp=Object(b.a)(y.a.mark((function e(){var t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({loading:!0});case 2:return localStorage.clear(),console.log("hi!"),e.next=6,fetch("/api/signup",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({username:n.state.username,password:n.state.password,confirmation:n.state.confirmation,first_name:n.state.first_name,last_name:n.state.last_name,email:n.state.email})});case 6:return 200===e.sent.status&&console.log("signed up"),e.next=10,fetch("/api/login",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({username:n.state.username,password:n.state.password})});case 10:if(200!==(t=e.sent).status){e.next=25;break}return e.next=14,t.json();case 14:a=e.sent,console.log(a),localStorage.setItem("user_id",a.user_id),localStorage.setItem("username",a.username),localStorage.setItem("email",a.email),localStorage.setItem("first_name",a.first_name),localStorage.setItem("last_name",a.last_name),n.props.logUserIn(),n.setState({toChannel:!0}),e.next=26;break;case 25:console.log("LOGIN FAILED");case 26:n.props.logUserIn();case 27:case"end":return e.stop()}}),e)}))),n.state={username:null,password:null,confirmation:null,first_name:null,last_name:null,email:null,toChannel:!1},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return!0===this.state.toChannel?l.a.createElement(v.a,{to:"/channel"}):l.a.createElement("div",{style:{border:"1px solid black",width:"75%",margin:"auto",maxWidth:"300px",minWidth:"200px"}},l.a.createElement("div",{style:{textAlign:"center",margin:"auto"}},l.a.createElement(w.a,null,l.a.createElement("label",null,"Username"),l.a.createElement(x.a,{type:"text",placeholder:"username",size:"large",onChange:this.changeUsername})),l.a.createElement(w.a,null,l.a.createElement("label",null," First Name "),l.a.createElement(x.a,{type:"text",placeholder:"First Name",size:"large",onChange:this.changeFirstName})),l.a.createElement(w.a,null,l.a.createElement("label",null," Last Name "),l.a.createElement(x.a,{type:"text",placeholder:"Last Name",size:"large",onChange:this.changeLastName})),l.a.createElement(w.a,null,l.a.createElement("label",null," Email "),l.a.createElement(x.a,{type:"text",placeholder:"Last Name",size:"large",onChange:this.changeEmail})),l.a.createElement(w.a,null,l.a.createElement("label",null,"Password"),l.a.createElement(x.a,{type:"password",size:"large",onChange:this.changePassword})),l.a.createElement(w.a,null,l.a.createElement("label",null,"Confirm Password"),l.a.createElement(x.a,{type:"password",size:"large",onChange:this.changeConfirmation})),l.a.createElement("div",null,l.a.createElement(j.a,{type:"primary",onClick:this.signUp},"Sign Up and Log In"))),l.a.createElement("div",{style:{fontSize:"12px",marginBottom:"8px"}}))}}]),t}(l.a.Component),M=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).changeChannelName=function(e){n.setState({newChannel:e.target.value})},n.pollForChannels=function(){fetch("/api/channels/view",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({user_id:localStorage.getItem("user_id")})}).then((function(e){return e.json()})).then((function(e){n.setState({channel_list:e}),console.log(e)}))},n.newChannel=function(){console.log("inserting new channel"),fetch("/api/channels/create",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({name:n.state.newChannel,user_id:localStorage.getItem("user_id")})}).then((function(){return n.pollForChannels()}))},n.chooseChannel=function(e){console.log("clicked",e),n.props.renderMessages(e)},n.deleteChannel=function(e){console.log("to delete",e),fetch("/api/channels/delete",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({name:e,user_id:localStorage.getItem("user_id")})}).then((function(e){200!==e.status?console.log("user cannot delete channel"):n.pollForChannels()}))},n.state={newChannel:null,user_id:localStorage.getItem("user_id"),channel_list:[]},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.pollForChannels(),this.interval=setInterval((function(){return e.pollForChannels()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.state.channel_list.map((function(t){return l.a.createElement("div",{className:"Channel-Row"},l.a.createElement("div",{className:"Channel-Column",style:{cursor:"pointer"},onClick:function(){return e.chooseChannel(t.name)}}," ",t.name," "),l.a.createElement("div",{className:"Channel-Column",style:{cursor:"pointer"},onClick:function(){return e.deleteChannel(t.name)}},"Delete"),l.a.createElement("div",{className:"Channel-Column"},t.unread_messages))}));return l.a.createElement("div",null,l.a.createElement(w.a,null,l.a.createElement("label",null,"Enter Channel Name"),l.a.createElement(x.a,{type:"text",placeholder:"Channel Name",size:"large",onChange:this.changeChannelName}),l.a.createElement(j.a,{style:{cursor:"pointer"},type:"primary",onClick:function(){return e.newChannel()}},"Create Channel")),l.a.createElement("div",{id:"channelspace"}," ",t))}}]),t}(l.a.Component),T=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).changeMessage=function(e){n.setState({newMessage:e.target.value})},n.pollForMessages=function(){fetch("api/channels/read/",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({name:n.props.clicked_channel,user_id:localStorage.getItem("user_id")})}).then((function(e){return e.json()})).then((function(e){n.setState({message_list:e})}))},n.newMessage=function(){console.log("posting message"),fetch("/api/messages/post",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({text:n.state.newMessage,username:localStorage.getItem("username"),name:n.props.clicked_channel})}).then(console.log("message posted!")).then(n.pollForMessages())},n.chooseMessage=function(e){console.log("clicked",e),n.props.renderThread(e)},n.validImage=function(e){var t=/(http(s?):)([/|.|\w|\s|\(\)#\:-])*\.(?:jpg|jpeg|gif|png|bmp|ico|svg|tiff|webp)/gi.exec(e);return console.log(t),t},n.state={newMessage:null,message_list:[]},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.pollForMessages(),this.interval=setInterval((function(){return e.pollForMessages()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.state.message_list.map((function(t){return l.a.createElement("div",{style:{cursor:"pointer "},onClick:function(){return e.chooseMessage(t)}},t.username,": ",t.body,l.a.createElement("br",null),null!==e.validImage(t.body)?l.a.createElement("img",{src:e.validImage(t.body)[0]}):null)}));return null===this.props.clicked_channel?l.a.createElement("p",{style:{textAlign:"center"}},"Click a Channel to view and post Messages!"):l.a.createElement("div",null,l.a.createElement(w.a,null,l.a.createElement("p",null,"Channel: ",this.props.clicked_channel),l.a.createElement("div",{style:{overflow:"scroll"},id:"chatspace"}," ",t),l.a.createElement(x.a,{type:"text",placeholder:"Enter Message",size:"large",onChange:this.changeMessage}),l.a.createElement(j.a,{style:{cursor:"pointer"},type:"primary",onClick:function(){return e.newMessage()}},"Post Message")))}}]),t}(l.a.Component),U=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).changeReply=function(e){n.setState({reply_text:e.target.value})},n.pollForReplies=function(){console.log(n.props.thread_id),fetch("/api/threads/read",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({msg_id:n.props.thread_id})}).then((function(e){return e.json()})).then((function(e){n.setState({reply_list:e})}))},n.newReply=function(){console.log("posting reply:",n.state.reply_text),fetch("/api/threads/post",{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"same-origin",method:"post",body:JSON.stringify({name:n.props.clicked_channel,msg_id:n.props.thread_id,user_id:localStorage.getItem("user_id"),message:n.state.reply_text})}).then(console.log("reply posted!")).then(n.pollForReplies())},n.validImage=function(e){var t=/(http(s?):)([/|.|\w|\s|\(\)#\:-])*\.(?:jpg|jpeg|gif|png|bmp|ico|svg|tiff|webp)/gi.exec(e);return console.log(t),t},n.state={reply_list:[],reply_text:null},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.pollForReplies(),this.interval=setInterval((function(){return e.pollForReplies()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.state.reply_list.map((function(t){return l.a.createElement("div",null," ",t.username," : ",t.body,l.a.createElement("br",null),null!==e.validImage(t.body)?l.a.createElement("img",{src:e.validImage(t.body)[0]}):null)}));return l.a.createElement("div",null,l.a.createElement("p",null,"Replies To: ",this.props.message),null!==this.validImage(this.props.message)?l.a.createElement("img",{src:this.validImage(this.props.message)[0]}):null,l.a.createElement("div",{id:"replyspace"},t),l.a.createElement(x.a,{type:"text",placeholder:"Enter Reply",size:"large",onChange:this.changeReply}),l.a.createElement(j.a,{style:{cursor:"pointer"},type:"primary",onClick:function(){return e.newReply()}},"Reply"))}}]),t}(l.a.Component),F=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).renderMessages=function(e){console.log(n.state.in_thread),n.setState({clicked_channel:e})},n.renderThread=function(e){console.log(e),n.setState({in_thread:!0,clicked_thread_id:e.message_id,clicked_message:e.body})},n.state={in_thread:!1,clicked_channel:null,clicked_thread_id:null,clicked_message:null},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"Channel-Cols"},l.a.createElement("div",null,l.a.createElement(M,{renderMessages:this.renderMessages})),l.a.createElement("div",{className:this.state.in_thread?"Skinny-Message-View":"Full-Message-View"},l.a.createElement(T,{in_thread:this.state.in_thread,clicked_channel:this.state.clicked_channel,renderThread:this.renderThread})),this.state.in_thread&&l.a.createElement(U,{clicked_channel:this.state.clicked_channel,thread_id:this.state.clicked_thread_id,message:this.state.clicked_message}))}}]),t}(l.a.Component),A=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).updateLoginStatus=function(){n.setState({loggedIn:d()})},n.state={loggedIn:!1},n.updateLoginStatus=n.updateLoginStatus.bind(Object(p.a)(n)),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement(O.a,null,l.a.createElement("div",{className:"Container"},l.a.createElement(_,null),l.a.createElement(v.d,null,l.a.createElement("div",{className:"Channel-Container"},l.a.createElement(v.b,{exact:!0,path:"/",key:"home",render:function(t){return l.a.createElement(N,{logUserIn:e.updateLoginStatus})}}),l.a.createElement(v.b,{path:"/login",key:"login",render:function(t){return l.a.createElement(I,{logUserIn:e.updateLoginStatus})}}),l.a.createElement(v.b,{path:"/channel",key:"channel",render:function(e){return l.a.createElement(F,null)}}),l.a.createElement(v.b,{path:"/signup",key:"signup",render:function(t){return l.a.createElement(N,{logUserIn:e.updateLoginStatus})}}),l.a.createElement(v.b,{path:"/logout",key:"logout",render:function(t){return l.a.createElement(E,{logUserOut:e.updateLoginStatus})}})),l.a.createElement(v.b,{component:k}))))}}]),t}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},52:function(e,t,n){e.exports=n.p+"static/media/belayer.5f9134d6.png"},61:function(e,t,n){e.exports=n(123)},66:function(e,t,n){},67:function(e,t,n){}},[[61,1,2]]]);
//# sourceMappingURL=main.6b3b6d30.chunk.js.map